<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Результаты тестов</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <main>
    <h3>Тесты</h3>
    <div id="test-results-container">
      <!-- Здесь будут отображаться результаты тестов -->
    </div>
  </main>

  <script>
    let db;
    const dbName = "UserAuthDB";
    const dbVersion = 1;

    // Открытие базы данных
    const request = indexedDB.open(dbName, dbVersion);

    request.onerror = (event) => {
      console.log("Ошибка при работе с базой данных", event);
    };

    request.onsuccess = (event) => {
      db = event.target.result;
      loadResultsFromDB(); // Загружаем результаты из базы данных
    };

    // Функция для загрузки и отображения результатов из IndexedDB
    function loadResultsFromDB() {
      if (db) {
        const transaction = db.transaction(["users"], "readonly");
        const store = transaction.objectStore("users");

        const request = store.getAll(); // Получаем все записи
        request.onsuccess = (event) => {
          const results = event.target.result;
          const resultsContainer = document.getElementById('test-results-container');
          let resultsHTML = '';

          if (results.length > 0) {
            results.forEach((result, index) => {
              resultsHTML += `
                <div>
                  <h4>Тест ${index + 1}</h4>
                  <p>Решено: <span id="test${index + 1}-result">
                    Правильные ответы: ${result.correctAnswers}, Неправильные ответы: ${result.incorrectAnswers}
                  </span></p>
                </div>
              `;
            });
          } else {
            resultsHTML = `<p>Пока нет данных по пройденным тестам.</p>`;
          }

          resultsContainer.innerHTML = resultsHTML;
        };
        request.onerror = (event) => {
          console.log("Ошибка при получении данных из базы данных:", event);
        };
      }
    }
  </script>
</body>
</html>
